{
  "id": "homepage-nav-ios",
  "data": {
    "metrics": {
      "fact__fzty744smgu520t0": {
        "id": "fact__fzty744smgu520t0",
        "name": "Searched",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": ["secondary"],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6": {
        "id": "fact__fzty744smgu50np6",
        "name": "Add to cart",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": ["secondary"],
        "compute_uncapped_metric": false
      },
      "fact__18p2i1nqlmh3zvzrf": {
        "id": "fact__18p2i1nqlmh3zvzrf",
        "name": "wdwjdajiw",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": ["guardrail"],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6?dim:browser=Chrome": {
        "id": "fact__fzty744smgu50np6?dim:browser=Chrome",
        "name": "Add to cart (browser: Chrome)",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": [],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6?dim:browser=Safari": {
        "id": "fact__fzty744smgu50np6?dim:browser=Safari",
        "name": "Add to cart (browser: Safari)",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": [],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6?dim:browser=Edge": {
        "id": "fact__fzty744smgu50np6?dim:browser=Edge",
        "name": "Add to cart (browser: Edge)",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": [],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6?dim:browser=Firefox": {
        "id": "fact__fzty744smgu50np6?dim:browser=Firefox",
        "name": "Add to cart (browser: Firefox)",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": [],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6?dim:browser=Samsung%20Internet": {
        "id": "fact__fzty744smgu50np6?dim:browser=Samsung%20Internet",
        "name": "Add to cart (browser: Samsung Internet)",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": [],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6?dim:browser=Opera": {
        "id": "fact__fzty744smgu50np6?dim:browser=Opera",
        "name": "Add to cart (browser: Opera)",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": [],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6?dim:browser=": {
        "id": "fact__fzty744smgu50np6?dim:browser=",
        "name": "Add to cart (browser: other)",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": [],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6?dim:country=US": {
        "id": "fact__fzty744smgu50np6?dim:country=US",
        "name": "Add to cart (country: US)",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": [],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6?dim:country=UK": {
        "id": "fact__fzty744smgu50np6?dim:country=UK",
        "name": "Add to cart (country: UK)",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": [],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6?dim:country=AU": {
        "id": "fact__fzty744smgu50np6?dim:country=AU",
        "name": "Add to cart (country: AU)",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": [],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6?dim:country=CA": {
        "id": "fact__fzty744smgu50np6?dim:country=CA",
        "name": "Add to cart (country: CA)",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": [],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu50np6?dim:country=": {
        "id": "fact__fzty744smgu50np6?dim:country=",
        "name": "Add to cart (country: other)",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "binomial",
        "covariate_metric_type": "binomial",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": [],
        "compute_uncapped_metric": false
      },
      "fact__fzty744smgu52kq1": {
        "id": "fact__fzty744smgu52kq1",
        "name": "BQ pageviews: Count per User",
        "inverse": false,
        "statistic_type": "mean_ra",
        "main_metric_type": "count",
        "covariate_metric_type": "count",
        "keep_theta": false,
        "prior_proper": true,
        "prior_mean": 0,
        "prior_stddev": 0.444,
        "target_mde": 0.1,
        "business_metric_type": ["secondary"],
        "compute_uncapped_metric": false
      }
    },
    "query_results": [
      {
        "metrics": [
          "fact__fzty744smgu520t0",
          "fact__fzty744smgu50np6",
          "fact__18p2i1nqlmh3zvzrf",
          "fact__fzty744smgu50np6?dim:browser=Chrome",
          "fact__fzty744smgu50np6?dim:browser=Safari",
          "fact__fzty744smgu50np6?dim:browser=Edge",
          "fact__fzty744smgu50np6?dim:browser=Firefox",
          "fact__fzty744smgu50np6?dim:browser=Samsung%20Internet",
          "fact__fzty744smgu50np6?dim:browser=Opera",
          "fact__fzty744smgu50np6?dim:browser=",
          "fact__fzty744smgu50np6?dim:country=US",
          "fact__fzty744smgu50np6?dim:country=UK",
          "fact__fzty744smgu50np6?dim:country=AU",
          "fact__fzty744smgu50np6?dim:country=CA",
          "fact__fzty744smgu50np6?dim:country="
        ],
        "rows": [
          {
            "variation": "2",
            "users": 10795,
            "count": 10795,
            "m0_id": "fact__fzty744smgu520t0",
            "m0_main_sum": 9956,
            "m0_main_sum_squares": 9956,
            "m0_covariate_sum": 3498,
            "m0_covariate_sum_squares": 3498,
            "m0_main_covariate_sum_product": 3141,
            "m1_id": "fact__fzty744smgu50np6",
            "m1_main_sum": 6812,
            "m1_main_sum_squares": 6812,
            "m1_covariate_sum": 1964,
            "m1_covariate_sum_squares": 1964,
            "m1_main_covariate_sum_product": 1115,
            "m2_id": "fact__18p2i1nqlmh3zvzrf",
            "m2_main_sum": 10436,
            "m2_main_sum_squares": 10436,
            "m2_covariate_sum": 3822,
            "m2_covariate_sum_squares": 3822,
            "m2_main_covariate_sum_product": 3645,
            "m3_id": "fact__fzty744smgu50np6?dim:browser=Chrome",
            "m3_main_sum": 3054,
            "m3_main_sum_squares": 3054,
            "m3_covariate_sum": 1660,
            "m3_covariate_sum_squares": 1660,
            "m3_main_covariate_sum_product": 324,
            "m4_id": "fact__fzty744smgu50np6?dim:browser=Safari",
            "m4_main_sum": 4987,
            "m4_main_sum_squares": 4987,
            "m4_covariate_sum": 0,
            "m4_covariate_sum_squares": 0,
            "m4_main_covariate_sum_product": 0,
            "m5_id": "fact__fzty744smgu50np6?dim:browser=Edge",
            "m5_main_sum": 213,
            "m5_main_sum_squares": 213,
            "m5_covariate_sum": 111,
            "m5_covariate_sum_squares": 111,
            "m5_main_covariate_sum_product": 0,
            "m6_id": "fact__fzty744smgu50np6?dim:browser=Firefox",
            "m6_main_sum": 199,
            "m6_main_sum_squares": 199,
            "m6_covariate_sum": 105,
            "m6_covariate_sum_squares": 105,
            "m6_main_covariate_sum_product": 2,
            "m7_id": "fact__fzty744smgu50np6?dim:browser=Samsung%20Internet",
            "m7_main_sum": 191,
            "m7_main_sum_squares": 191,
            "m7_covariate_sum": 74,
            "m7_covariate_sum_squares": 74,
            "m7_main_covariate_sum_product": 1,
            "m8_id": "fact__fzty744smgu50np6?dim:browser=Opera",
            "m8_main_sum": 91,
            "m8_main_sum_squares": 91,
            "m8_covariate_sum": 55,
            "m8_covariate_sum_squares": 55,
            "m8_main_covariate_sum_product": 1,
            "m9_id": "fact__fzty744smgu50np6?dim:browser=",
            "m9_main_sum": 0,
            "m9_main_sum_squares": 0,
            "m9_covariate_sum": 0,
            "m9_covariate_sum_squares": 0,
            "m9_main_covariate_sum_product": 0,
            "m10_id": "fact__fzty744smgu50np6?dim:country=US",
            "m10_main_sum": 4122,
            "m10_main_sum_squares": 4122,
            "m10_covariate_sum": 1184,
            "m10_covariate_sum_squares": 1184,
            "m10_main_covariate_sum_product": 680,
            "m11_id": "fact__fzty744smgu50np6?dim:country=UK",
            "m11_main_sum": 1362,
            "m11_main_sum_squares": 1362,
            "m11_covariate_sum": 395,
            "m11_covariate_sum_squares": 395,
            "m11_main_covariate_sum_product": 218,
            "m12_id": "fact__fzty744smgu50np6?dim:country=AU",
            "m12_main_sum": 671,
            "m12_main_sum_squares": 671,
            "m12_covariate_sum": 196,
            "m12_covariate_sum_squares": 196,
            "m12_main_covariate_sum_product": 109,
            "m13_id": "fact__fzty744smgu50np6?dim:country=CA",
            "m13_main_sum": 657,
            "m13_main_sum_squares": 657,
            "m13_covariate_sum": 189,
            "m13_covariate_sum_squares": 189,
            "m13_main_covariate_sum_product": 108,
            "m14_id": "fact__fzty744smgu50np6?dim:country=",
            "m14_main_sum": 0,
            "m14_main_sum_squares": 0,
            "m14_covariate_sum": 0,
            "m14_covariate_sum_squares": 0,
            "m14_main_covariate_sum_product": 0
          },
          {
            "variation": "1",
            "users": 10936,
            "count": 10936,
            "m0_id": "fact__fzty744smgu520t0",
            "m0_main_sum": 10094,
            "m0_main_sum_squares": 10094,
            "m0_covariate_sum": 3598,
            "m0_covariate_sum_squares": 3598,
            "m0_main_covariate_sum_product": 3232,
            "m1_id": "fact__fzty744smgu50np6",
            "m1_main_sum": 6877,
            "m1_main_sum_squares": 6877,
            "m1_covariate_sum": 1993,
            "m1_covariate_sum_squares": 1993,
            "m1_main_covariate_sum_product": 1143,
            "m2_id": "fact__18p2i1nqlmh3zvzrf",
            "m2_main_sum": 10568,
            "m2_main_sum_squares": 10568,
            "m2_covariate_sum": 3950,
            "m2_covariate_sum_squares": 3950,
            "m2_main_covariate_sum_product": 3761,
            "m3_id": "fact__fzty744smgu50np6?dim:browser=Chrome",
            "m3_main_sum": 3083,
            "m3_main_sum_squares": 3083,
            "m3_covariate_sum": 1677,
            "m3_covariate_sum_squares": 1677,
            "m3_main_covariate_sum_product": 304,
            "m4_id": "fact__fzty744smgu50np6?dim:browser=Safari",
            "m4_main_sum": 4959,
            "m4_main_sum_squares": 4959,
            "m4_covariate_sum": 0,
            "m4_covariate_sum_squares": 0,
            "m4_main_covariate_sum_product": 0,
            "m5_id": "fact__fzty744smgu50np6?dim:browser=Edge",
            "m5_main_sum": 215,
            "m5_main_sum_squares": 215,
            "m5_covariate_sum": 138,
            "m5_covariate_sum_squares": 138,
            "m5_main_covariate_sum_product": 0,
            "m6_id": "fact__fzty744smgu50np6?dim:browser=Firefox",
            "m6_main_sum": 194,
            "m6_main_sum_squares": 194,
            "m6_covariate_sum": 98,
            "m6_covariate_sum_squares": 98,
            "m6_main_covariate_sum_product": 2,
            "m7_id": "fact__fzty744smgu50np6?dim:browser=Samsung%20Internet",
            "m7_main_sum": 172,
            "m7_main_sum_squares": 172,
            "m7_covariate_sum": 76,
            "m7_covariate_sum_squares": 76,
            "m7_main_covariate_sum_product": 1,
            "m8_id": "fact__fzty744smgu50np6?dim:browser=Opera",
            "m8_main_sum": 118,
            "m8_main_sum_squares": 118,
            "m8_covariate_sum": 47,
            "m8_covariate_sum_squares": 47,
            "m8_main_covariate_sum_product": 0,
            "m9_id": "fact__fzty744smgu50np6?dim:browser=",
            "m9_main_sum": 0,
            "m9_main_sum_squares": 0,
            "m9_covariate_sum": 0,
            "m9_covariate_sum_squares": 0,
            "m9_main_covariate_sum_product": 0,
            "m10_id": "fact__fzty744smgu50np6?dim:country=US",
            "m10_main_sum": 4079,
            "m10_main_sum_squares": 4079,
            "m10_covariate_sum": 1180,
            "m10_covariate_sum_squares": 1180,
            "m10_main_covariate_sum_product": 661,
            "m11_id": "fact__fzty744smgu50np6?dim:country=UK",
            "m11_main_sum": 1440,
            "m11_main_sum_squares": 1440,
            "m11_covariate_sum": 412,
            "m11_covariate_sum_squares": 412,
            "m11_main_covariate_sum_product": 255,
            "m12_id": "fact__fzty744smgu50np6?dim:country=AU",
            "m12_main_sum": 674,
            "m12_main_sum_squares": 674,
            "m12_covariate_sum": 206,
            "m12_covariate_sum_squares": 206,
            "m12_main_covariate_sum_product": 114,
            "m13_id": "fact__fzty744smgu50np6?dim:country=CA",
            "m13_main_sum": 684,
            "m13_main_sum_squares": 684,
            "m13_covariate_sum": 195,
            "m13_covariate_sum_squares": 195,
            "m13_main_covariate_sum_product": 113,
            "m14_id": "fact__fzty744smgu50np6?dim:country=",
            "m14_main_sum": 0,
            "m14_main_sum_squares": 0,
            "m14_covariate_sum": 0,
            "m14_covariate_sum_squares": 0,
            "m14_main_covariate_sum_product": 0
          },
          {
            "variation": "0",
            "users": 21601,
            "count": 21601,
            "m0_id": "fact__fzty744smgu520t0",
            "m0_main_sum": 19987,
            "m0_main_sum_squares": 19987,
            "m0_covariate_sum": 7055,
            "m0_covariate_sum_squares": 7055,
            "m0_main_covariate_sum_product": 6380,
            "m1_id": "fact__fzty744smgu50np6",
            "m1_main_sum": 13770,
            "m1_main_sum_squares": 13770,
            "m1_covariate_sum": 3898,
            "m1_covariate_sum_squares": 3898,
            "m1_main_covariate_sum_product": 2181,
            "m2_id": "fact__18p2i1nqlmh3zvzrf",
            "m2_main_sum": 20883,
            "m2_main_sum_squares": 20883,
            "m2_covariate_sum": 7748,
            "m2_covariate_sum_squares": 7748,
            "m2_main_covariate_sum_product": 7419,
            "m3_id": "fact__fzty744smgu50np6?dim:browser=Chrome",
            "m3_main_sum": 6345,
            "m3_main_sum_squares": 6345,
            "m3_covariate_sum": 3301,
            "m3_covariate_sum_squares": 3301,
            "m3_main_covariate_sum_product": 672,
            "m4_id": "fact__fzty744smgu50np6?dim:browser=Safari",
            "m4_main_sum": 9780,
            "m4_main_sum_squares": 9780,
            "m4_covariate_sum": 0,
            "m4_covariate_sum_squares": 0,
            "m4_main_covariate_sum_product": 0,
            "m5_id": "fact__fzty744smgu50np6?dim:browser=Edge",
            "m5_main_sum": 483,
            "m5_main_sum_squares": 483,
            "m5_covariate_sum": 217,
            "m5_covariate_sum_squares": 217,
            "m5_main_covariate_sum_product": 3,
            "m6_id": "fact__fzty744smgu50np6?dim:browser=Firefox",
            "m6_main_sum": 425,
            "m6_main_sum_squares": 425,
            "m6_covariate_sum": 195,
            "m6_covariate_sum_squares": 195,
            "m6_main_covariate_sum_product": 1,
            "m7_id": "fact__fzty744smgu50np6?dim:browser=Samsung%20Internet",
            "m7_main_sum": 323,
            "m7_main_sum_squares": 323,
            "m7_covariate_sum": 168,
            "m7_covariate_sum_squares": 168,
            "m7_main_covariate_sum_product": 3,
            "m8_id": "fact__fzty744smgu50np6?dim:browser=Opera",
            "m8_main_sum": 200,
            "m8_main_sum_squares": 200,
            "m8_covariate_sum": 109,
            "m8_covariate_sum_squares": 109,
            "m8_main_covariate_sum_product": 0,
            "m9_id": "fact__fzty744smgu50np6?dim:browser=",
            "m9_main_sum": 0,
            "m9_main_sum_squares": 0,
            "m9_covariate_sum": 0,
            "m9_covariate_sum_squares": 0,
            "m9_main_covariate_sum_product": 0,
            "m10_id": "fact__fzty744smgu50np6?dim:country=US",
            "m10_main_sum": 8207,
            "m10_main_sum_squares": 8207,
            "m10_covariate_sum": 2303,
            "m10_covariate_sum_squares": 2303,
            "m10_main_covariate_sum_product": 1262,
            "m11_id": "fact__fzty744smgu50np6?dim:country=UK",
            "m11_main_sum": 2747,
            "m11_main_sum_squares": 2747,
            "m11_covariate_sum": 803,
            "m11_covariate_sum_squares": 803,
            "m11_main_covariate_sum_product": 451,
            "m12_id": "fact__fzty744smgu50np6?dim:country=AU",
            "m12_main_sum": 1430,
            "m12_main_sum_squares": 1430,
            "m12_covariate_sum": 422,
            "m12_covariate_sum_squares": 422,
            "m12_main_covariate_sum_product": 247,
            "m13_id": "fact__fzty744smgu50np6?dim:country=CA",
            "m13_main_sum": 1386,
            "m13_main_sum_squares": 1386,
            "m13_covariate_sum": 370,
            "m13_covariate_sum_squares": 370,
            "m13_main_covariate_sum_product": 221,
            "m14_id": "fact__fzty744smgu50np6?dim:country=",
            "m14_main_sum": 0,
            "m14_main_sum_squares": 0,
            "m14_covariate_sum": 0,
            "m14_covariate_sum_squares": 0,
            "m14_main_covariate_sum_product": 0
          }
        ],
        "sql": "-- Fact Table: BQ events\n    WITH\n      \n      \n    \n    __rawExperiment AS (\n      SELECT\n  userId as user_id,\n  timestamp as timestamp,\n  experimentId as experiment_id,\n  variationId as variation_id,\n  browser,\n  country\nFROM \n  `growthbook-ga4-demo.incremental_sample_data.experiment_viewed`\n    ),\n    __experimentExposures AS (\n      -- Viewed Experiment\n      SELECT\n        e.user_id as user_id\n        , cast(e.variation_id as string) as variation\n        , CAST(e.timestamp as DATETIME) as timestamp\n        \n      FROM\n          __rawExperiment e\n      WHERE\n          e.experiment_id = 'homepage-nav-ios'\n          AND e.timestamp >= '2025-10-21 00:00:00'\n          AND e.timestamp <= '2026-01-27 16:41:07'\n          \n    )\n    \n    \n    \n    , __experimentUnits AS (\n      -- One row per user\n      SELECT\n        e.user_id AS user_id\n        , (CASE WHEN count(distinct e.variation) > 1 THEN '__multiple__' ELSE max(e.variation) END) AS variation\n        , MIN(e.timestamp) AS first_exposure_timestamp\n        \n        \n        \n      FROM\n        __experimentExposures e\n        \n        \n        \n      \n      GROUP BY\n        e.user_id\n    ),\n      __distinctUsers AS (\n        SELECT\n          user_id\n          \n          , variation\n          , first_exposure_timestamp AS timestamp\n          , date_trunc(first_exposure_timestamp, DAY) AS first_exposure_date\n          \n          \n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) as min_preexposure_start\n              , first_exposure_timestamp as max_preexposure_end\n            \n      \n              , first_exposure_timestamp AS m0_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m0_preexposure_start\n\n              , first_exposure_timestamp AS m1_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m1_preexposure_start\n\n              , first_exposure_timestamp AS m2_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m2_preexposure_start\n\n              , first_exposure_timestamp AS m3_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m3_preexposure_start\n\n              , first_exposure_timestamp AS m4_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m4_preexposure_start\n\n              , first_exposure_timestamp AS m5_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m5_preexposure_start\n\n              , first_exposure_timestamp AS m6_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m6_preexposure_start\n\n              , first_exposure_timestamp AS m7_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m7_preexposure_start\n\n              , first_exposure_timestamp AS m8_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m8_preexposure_start\n\n              , first_exposure_timestamp AS m9_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m9_preexposure_start\n\n              , first_exposure_timestamp AS m10_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m10_preexposure_start\n\n              , first_exposure_timestamp AS m11_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m11_preexposure_start\n\n              , first_exposure_timestamp AS m12_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m12_preexposure_start\n\n              , first_exposure_timestamp AS m13_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m13_preexposure_start\n\n              , first_exposure_timestamp AS m14_preexposure_end\n              , DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m14_preexposure_start\n        FROM __experimentUnits\n        \n      )\n      , __factTable as (\n          -- Fact Table (BQ events)\n      SELECT\n        user_id as user_id,\n        CAST(m.timestamp as DATETIME) as timestamp,\n        -- Searched\n        CASE WHEN ((event = 'Search')) THEN 1 ELSE NULL END as m0_value,\n-- Add to cart\n        CASE WHEN ((event = 'Add to Cart')) THEN 1 ELSE NULL END as m1_value,\n-- wdwjdajiw\n        1 as m2_value,\n-- Add to cart (browser: Chrome)\n        CASE WHEN ((browser = 'Chrome')\n AND (event = 'Add to Cart')) THEN 1 ELSE NULL END as m3_value,\n-- Add to cart (browser: Safari)\n        CASE WHEN ((browser = 'Safari')\n AND (event = 'Add to Cart')) THEN 1 ELSE NULL END as m4_value,\n-- Add to cart (browser: Edge)\n        CASE WHEN ((browser = 'Edge')\n AND (event = 'Add to Cart')) THEN 1 ELSE NULL END as m5_value,\n-- Add to cart (browser: Firefox)\n        CASE WHEN ((browser = 'Firefox')\n AND (event = 'Add to Cart')) THEN 1 ELSE NULL END as m6_value,\n-- Add to cart (browser: Samsung Internet)\n        CASE WHEN ((browser = 'Samsung Internet')\n AND (event = 'Add to Cart')) THEN 1 ELSE NULL END as m7_value,\n-- Add to cart (browser: Opera)\n        CASE WHEN ((browser = 'Opera')\n AND (event = 'Add to Cart')) THEN 1 ELSE NULL END as m8_value,\n-- Add to cart (browser: other)\n        CASE WHEN ((browser NOT IN (\n  'Chrome',\n  'Safari',\n  'Edge',\n  'Firefox',\n  'Samsung Internet',\n  'Opera'\n))\n AND (event = 'Add to Cart')) THEN 1 ELSE NULL END as m9_value,\n-- Add to cart (country: US)\n        CASE WHEN ((country = 'US')\n AND (event = 'Add to Cart')) THEN 1 ELSE NULL END as m10_value,\n-- Add to cart (country: UK)\n        CASE WHEN ((country = 'UK')\n AND (event = 'Add to Cart')) THEN 1 ELSE NULL END as m11_value,\n-- Add to cart (country: AU)\n        CASE WHEN ((country = 'AU')\n AND (event = 'Add to Cart')) THEN 1 ELSE NULL END as m12_value,\n-- Add to cart (country: CA)\n        CASE WHEN ((country = 'CA')\n AND (event = 'Add to Cart')) THEN 1 ELSE NULL END as m13_value,\n-- Add to cart (country: other)\n        CASE WHEN ((country NOT IN (\n  'US',\n  'UK',\n  'AU',\n  'CA'\n))\n AND (event = 'Add to Cart')) THEN 1 ELSE NULL END as m14_value\n      FROM(\n          SELECT\n event,\n userid as user_id,\n anonymousid as anonymous_id,\n sessionid,\n browser,\n country,\n timestamp,\n value\nFROM `growthbook-ga4-demo.incremental_sample_data.events`\n        ) m\n        \n        WHERE m.timestamp >= '2025-10-07 00:00:00' AND m.timestamp <= '2026-01-27 16:41:07'\n    \n        )\n        , __userMetricJoin as (\n          SELECT\n            d.variation AS variation\n            , d.timestamp AS timestamp\n            \n            \n            , d.user_id AS user_id\n            , (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m0_value ELSE NULL END) as m0_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m1_value ELSE NULL END) as m1_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m2_value ELSE NULL END) as m2_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m3_value ELSE NULL END) as m3_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m4_value ELSE NULL END) as m4_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m5_value ELSE NULL END) as m5_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m6_value ELSE NULL END) as m6_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m7_value ELSE NULL END) as m7_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m8_value ELSE NULL END) as m8_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m9_value ELSE NULL END) as m9_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m10_value ELSE NULL END) as m10_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m11_value ELSE NULL END) as m11_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m12_value ELSE NULL END) as m12_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m13_value ELSE NULL END) as m13_value\n                  \n                  \n, (CASE WHEN m.timestamp >= d.timestamp\n      AND m.timestamp <= '2026-01-27 16:41:07'\n        \n       THEN m.m14_value ELSE NULL END) as m14_value\n                  \n                  \n          FROM\n            __distinctUsers d\n          LEFT JOIN __factTable m ON (\n            m.user_id = d.user_id\n          )\n        )\n      \n      , __userMetricAgg as (\n        -- Add in the aggregate metric value for each user\n        SELECT\n          umj.variation\n          \n          \n          , umj.user_id\n          , COALESCE(MAX(umj.m0_value), 0) AS m0_value\n                \n, COALESCE(MAX(umj.m1_value), 0) AS m1_value\n                \n, COALESCE(MAX(umj.m2_value), 0) AS m2_value\n                \n, COALESCE(MAX(umj.m3_value), 0) AS m3_value\n                \n, COALESCE(MAX(umj.m4_value), 0) AS m4_value\n                \n, COALESCE(MAX(umj.m5_value), 0) AS m5_value\n                \n, COALESCE(MAX(umj.m6_value), 0) AS m6_value\n                \n, COALESCE(MAX(umj.m7_value), 0) AS m7_value\n                \n, COALESCE(MAX(umj.m8_value), 0) AS m8_value\n                \n, COALESCE(MAX(umj.m9_value), 0) AS m9_value\n                \n, COALESCE(MAX(umj.m10_value), 0) AS m10_value\n                \n, COALESCE(MAX(umj.m11_value), 0) AS m11_value\n                \n, COALESCE(MAX(umj.m12_value), 0) AS m12_value\n                \n, COALESCE(MAX(umj.m13_value), 0) AS m13_value\n                \n, COALESCE(MAX(umj.m14_value), 0) AS m14_value\n                \n          \n        FROM\n          __userMetricJoin umj\n        \n        GROUP BY\n          umj.variation\n          \n          \n          , umj.user_id\n      )\n      \n      \n        , __userCovariateMetric as (\n          \n      SELECT \n        d.variation AS variation\n        \n        , d.user_id AS user_id\n        , COALESCE(MAX((CASE WHEN m.timestamp >= d.m0_preexposure_start AND m.timestamp < d.m0_preexposure_end THEN m0_value ELSE NULL END)), 0) as m0_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m1_preexposure_start AND m.timestamp < d.m1_preexposure_end THEN m1_value ELSE NULL END)), 0) as m1_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m2_preexposure_start AND m.timestamp < d.m2_preexposure_end THEN m2_value ELSE NULL END)), 0) as m2_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m3_preexposure_start AND m.timestamp < d.m3_preexposure_end THEN m3_value ELSE NULL END)), 0) as m3_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m4_preexposure_start AND m.timestamp < d.m4_preexposure_end THEN m4_value ELSE NULL END)), 0) as m4_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m5_preexposure_start AND m.timestamp < d.m5_preexposure_end THEN m5_value ELSE NULL END)), 0) as m5_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m6_preexposure_start AND m.timestamp < d.m6_preexposure_end THEN m6_value ELSE NULL END)), 0) as m6_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m7_preexposure_start AND m.timestamp < d.m7_preexposure_end THEN m7_value ELSE NULL END)), 0) as m7_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m8_preexposure_start AND m.timestamp < d.m8_preexposure_end THEN m8_value ELSE NULL END)), 0) as m8_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m9_preexposure_start AND m.timestamp < d.m9_preexposure_end THEN m9_value ELSE NULL END)), 0) as m9_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m10_preexposure_start AND m.timestamp < d.m10_preexposure_end THEN m10_value ELSE NULL END)), 0) as m10_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m11_preexposure_start AND m.timestamp < d.m11_preexposure_end THEN m11_value ELSE NULL END)), 0) as m11_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m12_preexposure_start AND m.timestamp < d.m12_preexposure_end THEN m12_value ELSE NULL END)), 0) as m12_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m13_preexposure_start AND m.timestamp < d.m13_preexposure_end THEN m13_value ELSE NULL END)), 0) as m13_value\n                \n, COALESCE(MAX((CASE WHEN m.timestamp >= d.m14_preexposure_start AND m.timestamp < d.m14_preexposure_end THEN m14_value ELSE NULL END)), 0) as m14_value\n                \n      FROM\n        __distinctUsers d\n      JOIN __factTable m ON (\n        m.user_id = d.user_id\n      )\n      WHERE \n        m.timestamp >= d.min_preexposure_start\n        AND m.timestamp < d.max_preexposure_end\n      GROUP BY\n        d.variation\n        \n        , d.user_id\n        )\n            \n      \n      -- One row per variation/dimension with aggregations\n      SELECT\n        m.variation AS variation\n        \n        , COUNT(*) AS users\n        \n           , cast('fact__fzty744smgu520t0' as string) as m0_id\n            \n            , SUM(COALESCE(m.m0_value, 0)) AS m0_main_sum\n            , SUM(POWER(COALESCE(m.m0_value, 0), 2)) AS m0_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m0_value, 0)) AS m0_covariate_sum\n                , SUM(POWER(COALESCE(c.m0_value, 0), 2)) AS m0_covariate_sum_squares\n                , SUM(COALESCE(m.m0_value, 0) * COALESCE(c.m0_value, 0)) AS m0_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6' as string) as m1_id\n            \n            , SUM(COALESCE(m.m1_value, 0)) AS m1_main_sum\n            , SUM(POWER(COALESCE(m.m1_value, 0), 2)) AS m1_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m1_value, 0)) AS m1_covariate_sum\n                , SUM(POWER(COALESCE(c.m1_value, 0), 2)) AS m1_covariate_sum_squares\n                , SUM(COALESCE(m.m1_value, 0) * COALESCE(c.m1_value, 0)) AS m1_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__18p2i1nqlmh3zvzrf' as string) as m2_id\n            \n            , SUM(COALESCE(m.m2_value, 0)) AS m2_main_sum\n            , SUM(POWER(COALESCE(m.m2_value, 0), 2)) AS m2_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m2_value, 0)) AS m2_covariate_sum\n                , SUM(POWER(COALESCE(c.m2_value, 0), 2)) AS m2_covariate_sum_squares\n                , SUM(COALESCE(m.m2_value, 0) * COALESCE(c.m2_value, 0)) AS m2_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6?dim:browser=Chrome' as string) as m3_id\n            \n            , SUM(COALESCE(m.m3_value, 0)) AS m3_main_sum\n            , SUM(POWER(COALESCE(m.m3_value, 0), 2)) AS m3_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m3_value, 0)) AS m3_covariate_sum\n                , SUM(POWER(COALESCE(c.m3_value, 0), 2)) AS m3_covariate_sum_squares\n                , SUM(COALESCE(m.m3_value, 0) * COALESCE(c.m3_value, 0)) AS m3_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6?dim:browser=Safari' as string) as m4_id\n            \n            , SUM(COALESCE(m.m4_value, 0)) AS m4_main_sum\n            , SUM(POWER(COALESCE(m.m4_value, 0), 2)) AS m4_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m4_value, 0)) AS m4_covariate_sum\n                , SUM(POWER(COALESCE(c.m4_value, 0), 2)) AS m4_covariate_sum_squares\n                , SUM(COALESCE(m.m4_value, 0) * COALESCE(c.m4_value, 0)) AS m4_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6?dim:browser=Edge' as string) as m5_id\n            \n            , SUM(COALESCE(m.m5_value, 0)) AS m5_main_sum\n            , SUM(POWER(COALESCE(m.m5_value, 0), 2)) AS m5_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m5_value, 0)) AS m5_covariate_sum\n                , SUM(POWER(COALESCE(c.m5_value, 0), 2)) AS m5_covariate_sum_squares\n                , SUM(COALESCE(m.m5_value, 0) * COALESCE(c.m5_value, 0)) AS m5_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6?dim:browser=Firefox' as string) as m6_id\n            \n            , SUM(COALESCE(m.m6_value, 0)) AS m6_main_sum\n            , SUM(POWER(COALESCE(m.m6_value, 0), 2)) AS m6_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m6_value, 0)) AS m6_covariate_sum\n                , SUM(POWER(COALESCE(c.m6_value, 0), 2)) AS m6_covariate_sum_squares\n                , SUM(COALESCE(m.m6_value, 0) * COALESCE(c.m6_value, 0)) AS m6_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6?dim:browser=Samsung%20Internet' as string) as m7_id\n            \n            , SUM(COALESCE(m.m7_value, 0)) AS m7_main_sum\n            , SUM(POWER(COALESCE(m.m7_value, 0), 2)) AS m7_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m7_value, 0)) AS m7_covariate_sum\n                , SUM(POWER(COALESCE(c.m7_value, 0), 2)) AS m7_covariate_sum_squares\n                , SUM(COALESCE(m.m7_value, 0) * COALESCE(c.m7_value, 0)) AS m7_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6?dim:browser=Opera' as string) as m8_id\n            \n            , SUM(COALESCE(m.m8_value, 0)) AS m8_main_sum\n            , SUM(POWER(COALESCE(m.m8_value, 0), 2)) AS m8_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m8_value, 0)) AS m8_covariate_sum\n                , SUM(POWER(COALESCE(c.m8_value, 0), 2)) AS m8_covariate_sum_squares\n                , SUM(COALESCE(m.m8_value, 0) * COALESCE(c.m8_value, 0)) AS m8_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6?dim:browser=' as string) as m9_id\n            \n            , SUM(COALESCE(m.m9_value, 0)) AS m9_main_sum\n            , SUM(POWER(COALESCE(m.m9_value, 0), 2)) AS m9_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m9_value, 0)) AS m9_covariate_sum\n                , SUM(POWER(COALESCE(c.m9_value, 0), 2)) AS m9_covariate_sum_squares\n                , SUM(COALESCE(m.m9_value, 0) * COALESCE(c.m9_value, 0)) AS m9_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6?dim:country=US' as string) as m10_id\n            \n            , SUM(COALESCE(m.m10_value, 0)) AS m10_main_sum\n            , SUM(POWER(COALESCE(m.m10_value, 0), 2)) AS m10_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m10_value, 0)) AS m10_covariate_sum\n                , SUM(POWER(COALESCE(c.m10_value, 0), 2)) AS m10_covariate_sum_squares\n                , SUM(COALESCE(m.m10_value, 0) * COALESCE(c.m10_value, 0)) AS m10_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6?dim:country=UK' as string) as m11_id\n            \n            , SUM(COALESCE(m.m11_value, 0)) AS m11_main_sum\n            , SUM(POWER(COALESCE(m.m11_value, 0), 2)) AS m11_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m11_value, 0)) AS m11_covariate_sum\n                , SUM(POWER(COALESCE(c.m11_value, 0), 2)) AS m11_covariate_sum_squares\n                , SUM(COALESCE(m.m11_value, 0) * COALESCE(c.m11_value, 0)) AS m11_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6?dim:country=AU' as string) as m12_id\n            \n            , SUM(COALESCE(m.m12_value, 0)) AS m12_main_sum\n            , SUM(POWER(COALESCE(m.m12_value, 0), 2)) AS m12_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m12_value, 0)) AS m12_covariate_sum\n                , SUM(POWER(COALESCE(c.m12_value, 0), 2)) AS m12_covariate_sum_squares\n                , SUM(COALESCE(m.m12_value, 0) * COALESCE(c.m12_value, 0)) AS m12_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6?dim:country=CA' as string) as m13_id\n            \n            , SUM(COALESCE(m.m13_value, 0)) AS m13_main_sum\n            , SUM(POWER(COALESCE(m.m13_value, 0), 2)) AS m13_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m13_value, 0)) AS m13_covariate_sum\n                , SUM(POWER(COALESCE(c.m13_value, 0), 2)) AS m13_covariate_sum_squares\n                , SUM(COALESCE(m.m13_value, 0) * COALESCE(c.m13_value, 0)) AS m13_main_covariate_sum_product\n                \n            \n          \n\n           , cast('fact__fzty744smgu50np6?dim:country=' as string) as m14_id\n            \n            , SUM(COALESCE(m.m14_value, 0)) AS m14_main_sum\n            , SUM(POWER(COALESCE(m.m14_value, 0), 2)) AS m14_main_sum_squares\n            \n            \n             \n              \n                    \n                , SUM(COALESCE(c.m14_value, 0)) AS m14_covariate_sum\n                , SUM(POWER(COALESCE(c.m14_value, 0), 2)) AS m14_covariate_sum_squares\n                , SUM(COALESCE(m.m14_value, 0) * COALESCE(c.m14_value, 0)) AS m14_main_covariate_sum_product\n                \n            \n          \n      FROM\n        __userMetricAgg m\n        \n      \n        \n        \n          LEFT JOIN __userCovariateMetric c ON (\n            c.user_id = m.user_id\n          )\n        \n        \n        \n      GROUP BY\n        m.variation\n        \n    \n      "
      },
      {
        "metrics": ["fact__fzty744smgu52kq1"],
        "rows": [
          {
            "variation": "0",
            "users": 21601,
            "count": 21601,
            "m0_id": "fact__fzty744smgu52kq1",
            "m0_main_sum": 0,
            "m0_main_sum_squares": 0,
            "m0_covariate_sum": 0,
            "m0_covariate_sum_squares": 0,
            "m0_main_covariate_sum_product": 0
          },
          {
            "variation": "2",
            "users": 10795,
            "count": 10795,
            "m0_id": "fact__fzty744smgu52kq1",
            "m0_main_sum": 0,
            "m0_main_sum_squares": 0,
            "m0_covariate_sum": 0,
            "m0_covariate_sum_squares": 0,
            "m0_main_covariate_sum_product": 0
          },
          {
            "variation": "1",
            "users": 10936,
            "count": 10936,
            "m0_id": "fact__fzty744smgu52kq1",
            "m0_main_sum": 0,
            "m0_main_sum_squares": 0,
            "m0_covariate_sum": 0,
            "m0_covariate_sum_squares": 0,
            "m0_main_covariate_sum_product": 0
          }
        ],
        "sql": "-- Fact Table: BQ pageviews\nWITH\n  __rawExperiment AS (\n    SELECT\n      userId as user_id,\n      timestamp as timestamp,\n      experimentId as experiment_id,\n      variationId as variation_id,\n      browser,\n      country\n    FROM\n      `growthbook-ga4-demo.incremental_sample_data.experiment_viewed`\n  ),\n  __experimentExposures AS (\n    -- Viewed Experiment\n    SELECT\n      e.user_id as user_id,\n      cast(e.variation_id as string) as variation,\n      CAST(e.timestamp as DATETIME) as timestamp\n    FROM\n      __rawExperiment e\n    WHERE\n      e.experiment_id = 'homepage-nav-ios'\n      AND e.timestamp >= '2025-10-21 00:00:00'\n      AND e.timestamp <= '2026-01-27 16:41:07'\n  ),\n  __experimentUnits AS (\n    -- One row per user\n    SELECT\n      e.user_id AS user_id,\n      (\n        CASE\n          WHEN count(distinct e.variation) > 1 THEN '__multiple__'\n          ELSE max(e.variation)\n        END\n      ) AS variation,\n      MIN(e.timestamp) AS first_exposure_timestamp\n    FROM\n      __experimentExposures e\n    GROUP BY\n      e.user_id\n  ),\n  __distinctUsers AS (\n    SELECT\n      user_id,\n      variation,\n      first_exposure_timestamp AS timestamp,\n      date_trunc(first_exposure_timestamp, DAY) AS first_exposure_date,\n      DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) as min_preexposure_start,\n      first_exposure_timestamp as max_preexposure_end,\n      first_exposure_timestamp AS m0_preexposure_end,\n      DATETIME_SUB(first_exposure_timestamp, INTERVAL 336 HOUR) AS m0_preexposure_start\n    FROM\n      __experimentUnits\n  ),\n  __factTable as (\n    -- Fact Table (BQ pageviews)\n    SELECT\n      user_id as user_id,\n      CAST(m.timestamp as DATETIME) as timestamp,\n      -- BQ pageviews: Count per User\n      1 as m0_value\n    FROM\n      (\n        SELECT\n          path,\n          cast(userid as string) as user_id,\n          anonymousid as anonymous_id,\n          sessionid,\n          browser,\n          country,\n          timestamp\n        FROM\n          `growthbook-ga4-demo.incremental_sample_data.pageViews`\n      ) m\n    WHERE\n      m.timestamp >= '2025-10-07 00:00:00'\n      AND m.timestamp <= '2026-01-27 16:41:07'\n  ),\n  __userMetricJoin as (\n    SELECT\n      d.variation AS variation,\n      d.timestamp AS timestamp,\n      d.user_id AS user_id,\n      (\n        CASE\n          WHEN m.timestamp >= d.timestamp\n          AND m.timestamp <= '2026-01-27 16:41:07' THEN m.m0_value\n          ELSE NULL\n        END\n      ) as m0_value\n    FROM\n      __distinctUsers d\n      LEFT JOIN __factTable m ON (m.user_id = d.user_id)\n  ),\n  __userMetricAgg as (\n    -- Add in the aggregate metric value for each user\n    SELECT\n      umj.variation,\n      umj.user_id,\n      COUNT(umj.m0_value) AS m0_value\n    FROM\n      __userMetricJoin umj\n    GROUP BY\n      umj.variation,\n      umj.user_id\n  ),\n  __userCovariateMetric as (\n    SELECT\n      d.variation AS variation,\n      d.user_id AS user_id,\n      COUNT(\n        (\n          CASE\n            WHEN m.timestamp >= d.m0_preexposure_start\n            AND m.timestamp < d.m0_preexposure_end THEN m0_value\n            ELSE NULL\n          END\n        )\n      ) as m0_value\n    FROM\n      __distinctUsers d\n      JOIN __factTable m ON (m.user_id = d.user_id)\n    WHERE\n      m.timestamp >= d.min_preexposure_start\n      AND m.timestamp < d.max_preexposure_end\n    GROUP BY\n      d.variation,\n      d.user_id\n  )\n  -- One row per variation/dimension with aggregations\nSELECT\n  m.variation AS variation,\n  COUNT(*) AS users,\n  cast('fact__fzty744smgu52kq1' as string) as m0_id,\n  SUM(COALESCE(m.m0_value, 0)) AS m0_main_sum,\n  SUM(POWER(COALESCE(m.m0_value, 0), 2)) AS m0_main_sum_squares,\n  SUM(COALESCE(c.m0_value, 0)) AS m0_covariate_sum,\n  SUM(POWER(COALESCE(c.m0_value, 0), 2)) AS m0_covariate_sum_squares,\n  SUM(COALESCE(m.m0_value, 0) * COALESCE(c.m0_value, 0)) AS m0_main_covariate_sum_product\nFROM\n  __userMetricAgg m\n  LEFT JOIN __userCovariateMetric c ON (c.user_id = m.user_id)\nGROUP BY\n  m.variation"
      }
    ],
    "analyses": [
      {
        "var_names": ["Control", "Variation 1", "Variation 2"],
        "var_ids": ["0", "1", "2"],
        "weights": [0.5, 0.25, 0.25],
        "baseline_index": 0,
        "dimension": "",
        "stats_engine": "bayesian",
        "p_value_corrected": false,
        "sequential_testing_enabled": false,
        "sequential_tuning_parameter": 5000,
        "difference_type": "relative",
        "phase_length_days": 98.66666666666667,
        "alpha": 0.05,
        "max_dimensions": 20,
        "traffic_percentage": 1,
        "num_goal_metrics": 0,
        "one_sided_intervals": false,
        "post_stratification_enabled": true
      },
      {
        "var_names": ["Control", "Variation 1", "Variation 2"],
        "var_ids": ["0", "1", "2"],
        "weights": [0.5, 0.25, 0.25],
        "baseline_index": 0,
        "dimension": "",
        "stats_engine": "bayesian",
        "p_value_corrected": false,
        "sequential_testing_enabled": false,
        "sequential_tuning_parameter": 5000,
        "difference_type": "absolute",
        "phase_length_days": 98.66666666666667,
        "alpha": 0.05,
        "max_dimensions": 20,
        "traffic_percentage": 1,
        "num_goal_metrics": 0,
        "one_sided_intervals": false,
        "post_stratification_enabled": true
      },
      {
        "var_names": ["Control", "Variation 1", "Variation 2"],
        "var_ids": ["0", "1", "2"],
        "weights": [0.5, 0.25, 0.25],
        "baseline_index": 0,
        "dimension": "",
        "stats_engine": "bayesian",
        "p_value_corrected": false,
        "sequential_testing_enabled": false,
        "sequential_tuning_parameter": 5000,
        "difference_type": "scaled",
        "phase_length_days": 98.66666666666667,
        "alpha": 0.05,
        "max_dimensions": 20,
        "traffic_percentage": 1,
        "num_goal_metrics": 0,
        "one_sided_intervals": false,
        "post_stratification_enabled": true
      }
    ],
    "bandit_settings": null
  }
}
